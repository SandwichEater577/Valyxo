<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Valyxo Online - Try Valyxo in your browser"
    />
    <title>Valyxo â€“ Online</title>
    <link rel="stylesheet" href="../CSS/style.css" />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.6.0/uicons-regular-rounded/css/uicons-regular-rounded.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      .online-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 40px 24px;
      }

      .online-hero {
        text-align: center;
        margin-bottom: 40px;
      }

      .online-hero h1 {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 12px;
      }

      .online-hero p {
        color: var(--text-secondary);
        font-size: 1.1rem;
      }

      .terminal-container {
        background: #0d1117;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        border: 1px solid var(--border);
      }

      .terminal-header {
        background: #161b22;
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        border-bottom: 1px solid var(--border);
      }

      .terminal-dots {
        display: flex;
        gap: 8px;
      }

      .terminal-dots span {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }

      .terminal-dots span:nth-child(1) {
        background: #ff5f56;
      }
      .terminal-dots span:nth-child(2) {
        background: #ffbd2e;
      }
      .terminal-dots span:nth-child(3) {
        background: #27c93f;
      }

      .terminal-title {
        color: var(--text-secondary);
        font-size: 0.875rem;
        font-family: "JetBrains Mono", monospace;
      }

      .terminal-body {
        padding: 0;
        height: 500px;
        overflow-y: auto;
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        line-height: 1.6;
      }

      .terminal-output {
        padding: 16px;
        white-space: pre-wrap;
        word-wrap: break-word;
      }

      .terminal-output .line {
        margin-bottom: 2px;
      }

      .terminal-output .prompt {
        color: #58a6ff;
      }

      .terminal-output .success {
        color: #3fb950;
      }

      .terminal-output .error {
        color: #f85149;
      }

      .terminal-output .info {
        color: #8b949e;
      }

      .terminal-output .banner {
        color: #a371f7;
      }

      .terminal-input-line {
        display: flex;
        align-items: center;
        padding: 0 16px 16px;
        gap: 8px;
      }

      .terminal-input-line .prompt {
        color: #58a6ff;
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        white-space: nowrap;
      }

      #terminal-input {
        flex: 1;
        background: transparent;
        border: none;
        outline: none;
        color: #c9d1d9;
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        caret-color: #58a6ff;
      }

      .online-info {
        margin-top: 40px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
      }

      .info-card {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 24px;
      }

      .info-card h3 {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 12px;
        font-size: 1.1rem;
      }

      .info-card h3 svg {
        opacity: 0.7;
      }

      .info-card p {
        color: var(--text-secondary);
        font-size: 0.95rem;
        line-height: 1.6;
      }

      .info-card code {
        background: rgba(255, 255, 255, 0.1);
        padding: 2px 6px;
        border-radius: 4px;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.85em;
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <a href="index.html" class="logo">
          <img src="../Assets/logo-without-text.png" alt="Valyxo Logo" />
          <span>Valyxo</span>
        </a>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="why.html">Why Valyxo?</a></li>
          <li><a href="online.html" class="active">Online</a></li>
          <li><a href="download.html">Download</a></li>
          <li><a href="project.html">Project</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <div class="online-container">
        <div class="online-hero">
          <h1>Valyxo <span class="gradient-text">Online</span></h1>
          <p>Try Valyxo directly in your browser â€” no installation required</p>
        </div>

        <div class="terminal-container">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span></span><span></span><span></span>
            </div>
            <span class="terminal-title">valyxo â€” online</span>
          </div>
          <div class="terminal-body">
            <div class="terminal-output" id="terminal-output"></div>
            <div class="terminal-input-line">
              <span class="prompt" id="prompt-text">valyxo:/> </span>
              <input
                type="text"
                id="terminal-input"
                autofocus
                autocomplete="off"
                spellcheck="false"
              />
            </div>
          </div>
        </div>

        <div class="online-info">
          <div class="info-card">
            <h3>
              <i class="fi fi-rr-interrogation"></i>
              Getting Started
            </h3>
            <p>
              Type <code>-help</code> to see available commands. Use
              <code>man &lt;command&gt;</code> for detailed documentation.
            </p>
          </div>
          <div class="info-card">
            <h3>
              <i class="fi fi-rr-terminal"></i>
              Terminal Commands
            </h3>
            <p>
              Navigate with <code>cd</code>, <code>ls</code>. Create files with
              <code>nano</code>. Run scripts with <code>run</code>.
            </p>
          </div>
          <div class="info-card">
            <h3>
              <i class="fi fi-rr-code-simple"></i>
              ValyxoScript
            </h3>
            <p>
              Enter <code>enter ValyxoScript</code> to use the built-in
              scripting language for automation.
            </p>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-brand">
          <img
            src="../Assets/logo-without-text.png"
            alt="Valyxo"
            class="footer-logo"
          />
          <span>Valyxo</span>
        </div>
        <nav class="footer-nav">
          <a href="index.html">Home</a>
          <a href="why.html">Why Valyxo?</a>
          <a href="online.html">Online</a>
          <a href="download.html">Download</a>
          <a href="project.html">Project</a>
          <a href="contact.html">Contact</a>
          <a href="https://github.com/SandwichEater577/Valyxo" target="_blank"
            >GitHub</a
          >
        </nav>
        <div class="footer-copy">
          &copy; 2025 Michal Kostkowski. All rights reserved.
        </div>
      </div>
    </footer>

    <script src="../JavaScript/animations.js"></script>
    <script>
      const output = document.getElementById("terminal-output");
      const input = document.getElementById("terminal-input");
      const promptText = document.getElementById("prompt-text");

      // Virtual filesystem
      let cwd = "/";
      const filesystem = {
        "/": {
          type: "dir",
          children: {
            projects: {
              type: "dir",
              children: {
                "hello.ns": {
                  type: "file",
                  content:
                    '// ValyxoScript Example\nprint "Hello, Valyxo!"\nlet x = 10\nprint x + 5',
                },
                "readme.txt": {
                  type: "file",
                  content:
                    "Welcome to Valyxo!\n\nThis is a demo project folder.\nTry running: run hello.ns",
                },
              },
            },
            docs: {
              type: "dir",
              children: {
                "commands.txt": {
                  type: "file",
                  content:
                    "Available Commands:\n- ls: List files\n- cd: Change directory\n- cat: View file\n- mkdir: Create directory\n- nano: Edit file\n- run: Execute script\n- clear: Clear screen\n- -help: Show help",
                },
              },
            },
          },
        },
      };

      // Command history
      const history = [];
      let historyIndex = -1;

      // Helper functions
      function getNode(path) {
        const parts = path.split("/").filter(Boolean);
        let node = filesystem["/"];
        for (const part of parts) {
          if (!node.children || !node.children[part]) return null;
          node = node.children[part];
        }
        return node;
      }

      function resolvePath(path) {
        if (path.startsWith("/")) return path;
        const parts = cwd.split("/").filter(Boolean);
        for (const part of path.split("/")) {
          if (part === "..") parts.pop();
          else if (part !== ".") parts.push(part);
        }
        return "/" + parts.join("/");
      }

      function printLine(text, className = "") {
        const line = document.createElement("div");
        line.className = "line " + className;
        line.textContent = text;
        output.appendChild(line);
      }

      function printHTML(html) {
        const line = document.createElement("div");
        line.className = "line";
        line.innerHTML = html;
        output.appendChild(line);
      }

      function updatePrompt() {
        promptText.textContent = `valyxo:${cwd}> `;
      }

      function scrollToBottom() {
        const body = document.querySelector(".terminal-body");
        body.scrollTop = body.scrollHeight;
      }

      // Startup banner
      function showStartup() {
        const banner = `
 __     __    _                      
 \\ \\   / /_ _| |_   ___  _____  
  \\ \\ / / _\` | | | | \\ \\/ / _ \\ 
   \\ V / (_| | | |_| |>  < (_) |
    \\_/ \\__,_|_|\\__, /_/\\_\\___/ 
                |___/            

  Welcome to Valyxo v0.5.1 - Online Edition
  Type '-help' for commands or 'man valyxo' for help
`;
        printLine(banner, "banner");
        printLine("");
      }

      // Commands
      const commands = {
        "-help": () => {
          printLine(
            `
â•­â”€ Valyxo v0.5.1 Commands â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                             â”‚
â”‚ Navigation & Files:                                         â”‚
â”‚   cd <path>              Change directory                   â”‚
â”‚   ls [path]              List files/folders                 â”‚
â”‚   mkdir <path>           Create directory                   â”‚
â”‚   cat <file>             Display file contents              â”‚
â”‚   nano <file>            Edit file (simplified)             â”‚
â”‚                                                             â”‚
â”‚ Execution:                                                  â”‚
â”‚   run <file>             Execute ValyxoScript               â”‚
â”‚                                                             â”‚
â”‚ Tools:                                                      â”‚
â”‚   clear                  Clear terminal                     â”‚
â”‚   man <command>          View documentation                 â”‚
â”‚   -help                  Show this help                     â”‚
â”‚                                                             â”‚
â”‚ Note: This is a browser demo. Download for full features.   â”‚
â”‚                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯`,
            "info"
          );
        },

        clear: () => {
          output.innerHTML = "";
        },

        ls: (args) => {
          const path = args ? resolvePath(args) : cwd;
          const node = getNode(path);
          if (!node || node.type !== "dir") {
            printLine(
              `ls: cannot access '${args}': No such directory`,
              "error"
            );
            return;
          }
          if (!node.children || Object.keys(node.children).length === 0) {
            printLine("(empty directory)", "info");
            return;
          }
          for (const name of Object.keys(node.children).sort()) {
            const child = node.children[name];
            const prefix = child.type === "dir" ? "ðŸ“ " : "ðŸ“„ ";
            printLine("  " + prefix + name);
          }
        },

        cd: (args) => {
          if (!args) {
            cwd = "/";
            updatePrompt();
            printLine("Changed to: /", "success");
            return;
          }
          const newPath = resolvePath(args);
          const node = getNode(newPath);
          if (!node || node.type !== "dir") {
            printLine(`cd: no such directory: ${args}`, "error");
            return;
          }
          cwd = newPath || "/";
          updatePrompt();
          printLine(`Changed to: ${cwd}`, "success");
        },

        cat: (args) => {
          if (!args) {
            printLine("Usage: cat <file>", "error");
            return;
          }
          const path = resolvePath(args);
          const node = getNode(path);
          if (!node) {
            printLine(`cat: ${args}: No such file`, "error");
            return;
          }
          if (node.type === "dir") {
            printLine(`cat: ${args}: Is a directory`, "error");
            return;
          }
          printLine(node.content);
        },

        mkdir: (args) => {
          if (!args) {
            printLine("Usage: mkdir <directory>", "error");
            return;
          }
          const parts = resolvePath(args).split("/").filter(Boolean);
          const name = parts.pop();
          const parentPath = "/" + parts.join("/");
          const parent = getNode(parentPath);
          if (!parent || parent.type !== "dir") {
            printLine(
              `mkdir: cannot create '${args}': No such parent directory`,
              "error"
            );
            return;
          }
          if (parent.children[name]) {
            printLine(
              `mkdir: cannot create '${args}': Already exists`,
              "error"
            );
            return;
          }
          parent.children[name] = { type: "dir", children: {} };
          printLine(`Created directory: ${args}`, "success");
        },

        nano: (args) => {
          if (!args) {
            printLine("Usage: nano <file>", "error");
            return;
          }
          printLine("Note: Full editor available in desktop version.", "info");
          printLine(
            `To create '${args}', use: echo "content" > ${args}`,
            "info"
          );
        },

        run: (args) => {
          if (!args) {
            printLine("Usage: run <file.ns>", "error");
            return;
          }
          const path = resolvePath(args);
          const node = getNode(path);
          if (!node || node.type === "dir") {
            printLine(`run: ${args}: No such file`, "error");
            return;
          }
          printLine(`Running ${args}...`, "info");
          // Simple ValyxoScript interpreter
          const lines = node.content.split("\n");
          const vars = {};
          for (const line of lines) {
            const trimmed = line.trim();
            if (!trimmed || trimmed.startsWith("//")) continue;
            if (trimmed.startsWith("print ")) {
              let val = trimmed.slice(6).trim();
              // Handle string literals
              if (val.startsWith('"') && val.endsWith('"')) {
                printLine(val.slice(1, -1), "success");
              } else {
                // Try to evaluate expression
                try {
                  const result = eval(
                    val.replace(/(\w+)/g, (m) =>
                      vars[m] !== undefined ? vars[m] : m
                    )
                  );
                  printLine(String(result), "success");
                } catch {
                  printLine(val);
                }
              }
            } else if (trimmed.startsWith("let ")) {
              const match = trimmed.match(/let\s+(\w+)\s*=\s*(.+)/);
              if (match) {
                const [, name, val] = match;
                try {
                  vars[name] = eval(val);
                } catch {
                  vars[name] = val;
                }
              }
            }
          }
          printLine("Script completed.", "success");
        },

        man: (args) => {
          if (!args) {
            printLine("Usage: man <command>", "error");
            printLine(
              "Available: ls, cd, cat, mkdir, nano, run, valyxo",
              "info"
            );
            return;
          }
          const manPages = {
            valyxo: `
VALYXO(1)                    User Commands                    VALYXO(1)

NAME
       valyxo - next-generation developer platform

DESCRIPTION
       Valyxo is a terminal-first developer platform with a built-in
       editor, scripting language (ValyxoScript), and development tools.

       This online version provides a preview of Valyxo's capabilities.
       Download the full version for complete features.

VERSION
       0.5.1

AUTHOR
       Michal Kostkowski (@SandwichEater577)
`,
            ls: "ls - list directory contents\n\nUsage: ls [path]\n\nList files and directories in the current or specified path.",
            cd: "cd - change directory\n\nUsage: cd [path]\n\nChange the current working directory. Use '..' to go up.",
            cat: "cat - display file contents\n\nUsage: cat <file>\n\nDisplay the contents of a file.",
            mkdir:
              "mkdir - create directory\n\nUsage: mkdir <name>\n\nCreate a new directory.",
            nano: "nano - text editor\n\nUsage: nano <file>\n\nEdit a file. Full editor available in desktop version.",
            run: "run - execute script\n\nUsage: run <file.ns>\n\nExecute a ValyxoScript file.",
          };
          if (manPages[args.toLowerCase()]) {
            printLine(manPages[args.toLowerCase()], "info");
          } else {
            printLine(`No manual entry for '${args}'`, "error");
          }
        },

        echo: (args) => {
          printLine(args || "");
        },
      };

      // Process command
      function processCommand(cmdLine) {
        const trimmed = cmdLine.trim();
        if (!trimmed) return;

        history.push(trimmed);
        historyIndex = history.length;

        printHTML(
          `<span class="prompt">${promptText.textContent}</span>${trimmed}`
        );

        const parts = trimmed.split(/\s+/);
        const cmd = parts[0].toLowerCase();
        const args = parts.slice(1).join(" ");

        if (cmd === "quit" || cmd === "exit") {
          printLine(
            "Use the browser to navigate away, or download the full app!",
            "info"
          );
          return;
        }

        if (commands[cmd]) {
          commands[cmd](args);
        } else {
          printLine(
            `Command not found: ${cmd}. Type '-help' for available commands.`,
            "error"
          );
        }
      }

      // Event listeners
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          processCommand(input.value);
          input.value = "";
          scrollToBottom();
        } else if (e.key === "ArrowUp") {
          e.preventDefault();
          if (historyIndex > 0) {
            historyIndex--;
            input.value = history[historyIndex];
          }
        } else if (e.key === "ArrowDown") {
          e.preventDefault();
          if (historyIndex < history.length - 1) {
            historyIndex++;
            input.value = history[historyIndex];
          } else {
            historyIndex = history.length;
            input.value = "";
          }
        }
      });

      // Focus input when clicking terminal
      document.querySelector(".terminal-body").addEventListener("click", () => {
        input.focus();
      });

      // Initialize
      showStartup();
      updatePrompt();
    </script>
  </body>
</html>
